<div class="form-group">
    <label for="albumProvider" class="form-label">Album Provider:</label>
    <select id="albumProvider" name="albumProvider" class="form-input" onchange="updateTitleOptions(this.value)">
        <option value="Immich">Immich</option>
    </select>
</div>

<div class="form-group">
    <label for="url" class="form-label">Base URL:</label>
    <input type="text" id="url" name="url" placeholder="Type something..." required class="form-input">
     <label for="album" class="form-label">Album Name:</label>
    <input type="text" id="album" name="album" placeholder="Type something..." required class="form-input">
</div>

<div class="form-group">
    <div class="form-group">
        <label for="padImage" class="form-label">Scale to Fit:</label>
        <div class="toggle-container">
            <input type="checkbox" id="padImage" name="padImage" class="toggle-checkbox" value="false">
            <label for="padImage" class="toggle-label"></label>
        </div>
        <!-- Hidden input ensures 'true' is always sent when unchecked -->
        <input type="hidden" name="padImage" value="true">
        <small style="display: block; margin-top: 5px; color: #666; font-size: 0.9em;">
            When enabled: adds padding with blur/color background. When disabled: stretches image to fill screen.
        </small>
    </div>

    <div class="form-group">
        <label for="orientationFilter" class="form-label">Match Orientation:</label>
        <div class="toggle-container">
            <!-- Checkbox for display only, doesn't submit -->
            <input type="checkbox" id="orientationFilterCheckbox" class="toggle-checkbox" checked
                onchange="updateOrientationFilterValue()">
            <label for="orientationFilterCheckbox" class="toggle-label"></label>
        </div>
        <!-- Hidden input that actually submits the value -->
        <input type="hidden" id="orientationFilter" name="orientationFilter" value="true">
        <small style="display: block; margin-top: 5px; color: #666; font-size: 0.9em;">
            When enabled: only selects images matching the display orientation (landscape/portrait) and crops them to fill the screen.
            Background settings apply only when disabled.
        </small>
    </div>

   <div class="form-group">
        <label for="randomize" class="form-label">Random Order:</label>
        <div class="toggle-container">
            <input type="checkbox" id="randomize" name="randomize" class="toggle-checkbox" value="false"
                onclick="this.value = this.checked ? 'true' : 'false'">
            <label for="randomize" class="toggle-label"></label>
        </div>
    </div>

    <div class="form-group">
        <label class="form-label" for="backgroundOption">Background <small style="color: #888;">(when Match Orientation is off)</small>:</label>
        <div class="form-group">
            <input type="radio" id="backgroundOption" name="backgroundOption" value="blur">
            <label>Blur</label>
            <input type="radio" id="backgroundOption" name="backgroundOption" value="color">
            <label>Color</label>
            <input type="color" id="backgroundColor" name="backgroundColor" value="#ffffff" class="color-picker"/>
        </div>
    </div>
</div>

<script>
    // Update hidden input value when checkbox changes
    function updateOrientationFilterValue() {
        const checkbox = document.getElementById('orientationFilterCheckbox');
        const hiddenInput = document.getElementById('orientationFilter');
        hiddenInput.value = checkbox.checked ? 'true' : 'false';
        console.log('Orientation filter changed to:', hiddenInput.value);
    }

    // populate form values from plugin settings
    document.addEventListener('DOMContentLoaded', () => {
        let backgroundOption = "blur"
        if (loadPluginSettings) {
            document.getElementById('url').value = pluginSettings.url;
            document.getElementById('album').value = pluginSettings.album;
            document.getElementById('padImage').checked = pluginSettings.padImage == 'false';
            document.getElementById('randomize').checked = pluginSettings.randomize;
            document.getElementById('backgroundColor').value = pluginSettings.backgroundColor;
            backgroundOption = pluginSettings.backgroundOption || 'blur'

            // Load orientation filter setting (default: true)
            const orientationFilter = pluginSettings.orientationFilter !== undefined ?
                pluginSettings.orientationFilter === 'true' : true;
            document.getElementById('orientationFilterCheckbox').checked = orientationFilter;
            document.getElementById('orientationFilter').value = orientationFilter ? 'true' : 'false';

            console.log('Loaded orientation filter setting:', orientationFilter);
        }
        document.querySelector(`input[name="backgroundOption"][value="${backgroundOption}"]`).checked = true;
    });
</script>
